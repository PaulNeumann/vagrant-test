## Background
Tim Hall (@oraclebase) noted in [a February 28 blog post](https://oracle-base.com/blog/2019/02/28/oracle-database-19c-installations-rac-data-guard-and-upgrades/) that Oracle Database 19c (19.2.0) is available for download from the [Oracle Software Delivery Cloud](https://edelivery.oracle.com/). I decided to try to implement a 19c Vagrant box, using the conventions from Oracle's [vagrant-boxes repository](https://github.com/oracle/vagrant-boxes) on GitHub.

## Implementation
I started with the configuration files from the Oracle Database 18c box, and made the changes listed below. This looks like a long list, but the changes needed are minor.

#### `README.md`
* Updated box name in heading
* Added note stating that this is a preview only
* Updated URL for downloading database installer
* Updated default ORACLE_HOME location (directory name)
* In description of connection parameters, changed "OEM port" to "EM Express port" to more accurately describe the functionality
* In password reset instructions, added text to clarify that one needs to switch to the oracle user before running `setPassword.sh`

#### `Vagrantfile`
* Updated box name
* Updated ORACLE_HOME environment variable (directory name)
* Increased RAM from 2 GB to 3 GB to avoid the following memory warning during installation:
```
    oracle-19c-vagrant: [WARNING] [DBT-11209] Current available memory is less than the required available memory (1,536MB) for creating the database.
    oracle-19c-vagrant:    CAUSE: Following nodes do not have required available memory :
    oracle-19c-vagrant:  Node:oracle-19c-vagrant		Available memory:1.3943GB (1461996.0KB)
```

#### `ora-response/db_install.rsp.tmpl`
* Updated responseFileVersion parameter

#### `ora-response/dbca.rsp.tmpl`
* Updated responseFileVersion parameter

#### `scripts/install.sh`
* Updated file name of installer zip. **This is the only required change to `install.sh`. The remaining changes are suggested, but optional.**

* Added quotes to echo statements where they were previously omitted
* Removed all occurrences of `sudo`. Since the script runs as root, sudo isn't needed.
* Double-quoted some environment variables to address [ShellCheck](https://www.shellcheck.net) warnings
* Removed manual creation of `tnsnames.ora`. This file is created by DBCA, and it's overwritten by DBCA if it's already present. Later in `install.sh`, permissions on `tnsnames.ora` are updated, and an entry is added for the PDB. This is more fully explained below.
* Removed unnecessary trailing spaces
* Replaced backticks with `$()` when creating ORACLE_PWD to address [ShellCheck](https://www.shellcheck.net) warning
* Removed unnecessary trailing semicolons
* Added code to enable global port for EM Express, as is done for the 18c XE box
* Updated ownership and execute permissions on `setPassword.sh`, so that all files in the oracle user's home directory are owned by oracle, and so that only the oracle user has permission to execute the script. Other users don't need permission to execute this script. It uses `/ as sysdba`, so it will work only for members of the dba group.
* Replaced double-quotes with single quotes in echo statements where variable expansion isn't needed

### Notes on tnsnames.ora
As noted above, I changed how tnsnames.ora is created for this box. Instead of creating it manually, the `install.sh` script lets DBCA create it. Then, after DBCA runs, `install.sh` updates permissions for tnsnames.ora and adds an entry for the PDB. The permission update allows all users, including the vagrant user, to read the file. This lets the vagrant user use TNS to connect to the database. Adding an entry for the PDB allows TNS connections to the PDB by all OS users.

When tnsnames.ora is manually created in `install.sh`, the content that's written to the file is overwritten by DBCA. Here's what the file looks ends up looking like when it's manually created using the code in `install.sh` from the 18c box, then overwritten by DBCA:
```
# tnsnames.ora Network Configuration File: /opt/oracle/product/19c/dbhome_1/network/admin/tnsnames.ora
# Generated by Oracle configuration tools.

ORCLCDB =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = ORCLCDB)
    )
  )

LISTENER_ORCLCDB =
  (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))


ORCLPDB1 =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 0.0.0.0)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = ORCLPDB1)
    )
  )
```
This is exactly what we want, but it's **NOT** what was originally echo'd to the file, which is confusing. To eliminate the confusion, I decided to let DBCA create the file, then modify as needed it later in `install.sh`.


When DBCA creates the tnsnames.ora file, the CDB entries are identical to those shown above. As mentioned, though, there are two issues with the DBCA-created file:
* First, file permissions are are `-rw-r-----`, which means that it isn't readable by all users.
* Second, there's no entry for the PDB.

(As a side note, both of these issues also occur with the Oracle Database 18c XE installer.)

It's simple to add code to `install.sh` to change the permissions and add the PDB entry. After these changes, all OS users can use TNS to connect to both the CDB and the PDB.

## Conclusion
It turned out to be pretty easy to create a working 19c box. The code for the Oracle Vagrant boxes is both robust and flexible, so it's easy to adapt to new releases.

I hope this helps!